<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0">
    <title>AR Mobile - Model7</title>
    
    <!-- A-Frame e AR.js para dispositivos móveis -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #arjsDebugUIContainer {
            display: none;
        }
        
        .controls {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            padding: 10px;
        }
        
        .controls button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            touch-action: manipulation;
        }
        
        .controls button:active {
            background: #45a049;
        }
        
        .info {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 998;
        }
    </style>
</head>

<body>
    <div class="info">
        <p><strong>AR Mobile - Model7</strong></p>
        <p>Aponte a câmera para os marcadores:</p>
        <p>• HIRO: Modelo principal com animação</p>
        <p>• Código #17: Formas geométricas</p>
        <p>• Código #10: Modelo secundário</p>
    </div>

    <div class="controls">
        <button onclick="toggleModel('model7')">Toggle Model7</button>
        <button onclick="toggleAnimation()">Toggle Animação</button>
        <button onclick="resetScale()">Reset Scale</button>
    </div>

    <a-scene 
        vr-mode-ui="enabled: false" 
        embedded 
        arjs="sourceType: webcam; trackingMethod: best; detectionMode: mono_and_matrix; matrixCodeType: 3x3; debugUIEnabled: false; patternRatio: 0.8;"
        renderer="logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true;"
        background="color: transparent">
        
        <a-assets>
            <!-- Modelo principal Model7 -->
            <a-asset-item id="model7" src="model7.glb"></a-asset-item>
            
            <!-- Modelos adicionais para outros marcadores -->
            <a-asset-item id="helicoptero" src="objetos/helicoptero.glb"></a-asset-item>
            <a-asset-item id="helicea" src="objetos/helicea.glb"></a-asset-item>
            <a-asset-item id="heliceb" src="objetos/heliceb.glb"></a-asset-item>
            
            <!-- Texturas e materiais -->
            <a-mixin id="base-material" material="shader: standard; metalness: 0.2; roughness: 0.8;"></a-mixin>
        </a-assets>

        <!-- Marcador HIRO - Modelo Model7 principal -->
        <a-marker preset="hiro" id="hiro-marker">
            <a-entity id="hiro-content" scale="0.8 0.8 0.8" position="0 0.2 0" rotation="0 0 0">
                <!-- Modelo Model7 principal -->
                <a-gltf-model 
                    id="main-model7"
                    src="#model7" 
                    class="model7-entity" 
                    visible="true"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 8000; easing: linear"
                    animation__scale="property: scale; to: 1.1 1.1 1.1; direction: alternate; loop: true; dur: 2000; easing: easeInOutQuad">
                </a-gltf-model>
                
                <!-- Elementos decorativos ao redor -->
                <a-entity position="2 0 0" rotation="0 45 0">
                    <a-box color="#FF6B6B" width="0.3" height="0.3" depth="0.3" 
                           animation="property: rotation; to: 360 360 0; loop: true; dur: 3000; easing: linear">
                    </a-box>
                </a-entity>
                
                <a-entity position="-2 0 0" rotation="0 -45 0">
                    <a-sphere color="#4ECDC4" radius="0.2"
                              animation="property: position; to: -2 1 0; direction: alternate; loop: true; dur: 2500; easing: easeInOutSine">
                    </a-sphere>
                </a-entity>
                
                <!-- Partículas/efeitos visuais -->
                <a-entity position="0 2 0">
                    <a-torus color="#FFE66D" radius="0.3" radius-tubular="0.05" 
                             animation="property: rotation; to: 0 0 360; loop: true; dur: 4000; easing: linear">
                    </a-torus>
                </a-entity>
            </a-entity>
        </a-marker>

        <!-- Marcador Barcode #17 - Formas geométricas com Model7 menor -->
        <a-marker type="barcode" value="17" id="barcode17-marker">
            <a-entity id="barcode17-content" position="0 0.1 0" scale="0.5 0.5 0.5">
                <!-- Model7 em escala menor -->
                <a-gltf-model 
                    src="#model7" 
                    position="0 1 0"
                    scale="0.4 0.4 0.4"
                    animation="property: rotation; to: 0 -360 0; loop: true; dur: 6000; easing: linear">
                </a-gltf-model>
                
                <!-- Octaedro animado -->
                <a-entity position="1.5 1 -1" animation="property: rotation; to: 0 360 0; dur: 5000; easing: linear; loop: true">
                    <a-octahedron color="#FF9500" radius="0.8" opacity="0.8"></a-octahedron>
                    <a-octahedron color="#FFFFFF" radius="0.8" wireframe="true"></a-octahedron>
                </a-entity>
                
                <!-- Cubo base -->
                <a-box position="1.5 0.5 -1" scale="1.5 1.5 1.5" color="#6C5CE7" opacity="0.6"
                       animation="property: scale; to: 1.8 1.8 1.8; direction: alternate; loop: true; dur: 3000; easing: easeInOutQuad">
                </a-box>
                
                <!-- Texto informativo -->
                <a-text position="-1 0 2" rotation="-90 0 0" 
                        text="width: 8; side: double; color: #FFFFFF; font: dejavu" 
                        value="Model7 AR Experience">
                </a-text>
            </a-entity>
        </a-marker>

        <!-- Marcador Barcode #10 - Modelo secundário com Model7 -->
        <a-marker type="barcode" value="10" id="barcode10-marker">
            <a-entity id="barcode10-content" scale="0.6 0.6 0.6" position="0 0.1 0">
                <!-- Model7 como elemento principal -->
                <a-gltf-model 
                    src="#model7"
                    position="0 0 0"
                    rotation="0 45 0"
                    animation-mixer
                    animation="property: position; to: 0 1 0; direction: alternate; loop: true; dur: 4000; easing: easeInOutQuad">
                </a-gltf-model>
                
                <!-- Helicóptero como elemento secundário -->
                <a-entity position="2 0.5 2" scale="0.3 0.3 0.3">
                    <a-gltf-model src="#helicoptero"></a-gltf-model>
                    <a-entity position="0 0 0">
                        <a-gltf-model src="#helicea" 
                                      animation="property: rotation; to: 0 360 0; loop: true; dur: 2000; easing: linear">
                        </a-gltf-model>
                    </a-entity>
                    <a-entity position="0.037 1.947 5.267" rotation="10 0 0">
                        <a-gltf-model src="#heliceb" 
                                      animation="property: rotation; to: 360 0 0; loop: true; dur: 1600; easing: linear">
                        </a-gltf-model>
                    </a-entity>
                </a-entity>
            </a-entity>
        </a-marker>

        <!-- Câmera otimizada para mobile -->
        <a-entity camera 
                  look-controls="enabled: true; touchEnabled: true"
                  wasd-controls="enabled: false">
        </a-entity>
        
        <!-- Iluminação otimizada -->
        <a-light type="ambient" color="#FFFFFF" intensity="0.8"></a-light>
        <a-light type="directional" color="#FFFFFF" intensity="1.2" position="-2 4 2"></a-light>
        <a-light type="directional" color="#FFFFFF" intensity="0.8" position="2 4 2"></a-light>
        <a-light type="point" color="#FFE66D" intensity="0.5" position="0 3 0"></a-light>
    </a-scene>

    <script>
        // Variáveis globais para controle
        let animationEnabled = true;
        let currentScale = 1;
        
        // Função para alternar visibilidade do Model7
        function toggleModel(modelId) {
            const models = document.querySelectorAll('.model7-entity');
            models.forEach(model => {
                model.setAttribute('visible', !model.getAttribute('visible'));
            });
        }
        
        // Função para alternar animações
        function toggleAnimation() {
            const animatedElements = document.querySelectorAll('[animation]');
            animationEnabled = !animationEnabled;
            
            animatedElements.forEach(element => {
                if (animationEnabled) {
                    element.setAttribute('animation', element.getAttribute('animation'));
                } else {
                    element.removeAttribute('animation');
                }
            });
        }
        
        // Função para resetar escala
        function resetScale() {
            const markers = document.querySelectorAll('a-marker');
            markers.forEach(marker => {
                const content = marker.querySelector('[id$="-content"]');
                if (content) {
                    content.setAttribute('scale', '0.8 0.8 0.8');
                }
            });
        }
        
        // Otimizações para dispositivos móveis
        window.addEventListener('load', function() {
            console.log('AR Mobile App carregada com sucesso!');
            
            // Configurações específicas para mobile
            if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                document.querySelector('a-scene').setAttribute('renderer', 
                    'logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true; antialias: false');
                
                // Reduzir qualidade em dispositivos menos potentes
                const canvas = document.querySelector('canvas');
                if (canvas) {
                    canvas.style.imageRendering = 'pixelated';
                }
            }
        });
        
        // Eventos de marcador detectado/perdido
        document.querySelectorAll('a-marker').forEach(marker => {
            marker.addEventListener('markerFound', function() {
                console.log('Marcador encontrado:', marker.id);
                const content = marker.querySelector('[id$="-content"]');
                if (content) {
                    content.setAttribute('visible', true);
                }
            });
            
            marker.addEventListener('markerLost', function() {
                console.log('Marcador perdido:', marker.id);
                const content = marker.querySelector('[id$="-content"]');
                if (content) {
                    content.setAttribute('visible', false);
                }
            });
        });
        
        // Prevenção de zoom no mobile
        document.addEventListener('touchmove', function(event) {
            if (event.scale !== 1) {
                event.preventDefault();
            }
        }, { passive: false });
        
        // Orientação da tela
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                window.location.reload();
            }, 500);
        });
    </script>
</body>
</html>